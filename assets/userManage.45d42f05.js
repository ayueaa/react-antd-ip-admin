import{a7 as A,r as c,k as E,j as u,a8 as z}from"./index.db5181c7.js";import{b as R,c as P,d as B}from"./user.api.0d9a03b2.js";import{F as k,S as N}from"./index.90a6ec4d.js";import{P as F}from"./index.45d3749b.js";import{B as x}from"./button.16cfc251.js";import{M as _}from"./index.8b561d37.js";import{T as j}from"./Table.bd56f342.js";import{T as U}from"./index.7c575b5f.js";import{S as O}from"./index.939c5ec2.js";import{R as I,u as V}from"./useReduxContext.445f29df.js";import"./index.9c20e89e.js";import"./index.e721e410.js";import"./useSize.70a35bba.js";import"./context.a2b898dd.js";import"./index.61db1a0a.js";import"./useMergedState.327c3824.js";import"./reactNode.265b0311.js";import"./Compact.99095ef9.js";import"./index.6c997b81.js";import"./row.f4791e76.js";import"./responsiveObserver.85af1e78.js";import"./QuestionCircleOutlined.3eec80dd.js";import"./CheckOutlined.1e909287.js";import"./index.12a1b7f5.js";import"./pickAttrs.404b2d76.js";import"./useBreakpoint.89bd27bc.js";import"./index.c83deb50.js";import"./Overflow.0fc5040c.js";import"./List.2af81052.js";import"./index.98d1759f.js";import"./compact-item.10726c4a.js";import"./SearchOutlined.5f8f5c65.js";import"./useClosable.9da53335.js";import"./fade.524f7f9e.js";import"./styleChecker.8851a1ee.js";import"./scrollTo.9e85775e.js";import"./index.2e411e76.js";import"./index.7d617dee.js";import"./EllipsisOutlined.b9487094.js";import"./index.9c4b6e74.js";import"./index.a3668735.js";import"./TextArea.e1c4056d.js";function W(){var s=A(),i=null,n=null;return{clear:function(){i=null,n=null},notify:function(){s(function(){for(var r=i;r;)r.callback(),r=r.next})},get:function(){for(var r=[],a=i;a;)r.push(a),a=a.next;return r},subscribe:function(r){var a=!0,t=n={callback:r,next:null,prev:n};return t.prev?t.prev.next=t:i=t,function(){!a||i===null||(a=!1,t.next?t.next.prev=t.prev:n=t.prev,t.prev?t.prev.next=t.next:i=t.next)}}}}var L={notify:function(){},get:function(){return[]}};function Y(s,i){var n,o=L;function r(m){return p(),o.subscribe(m)}function a(){o.notify()}function t(){f.onStateChange&&f.onStateChange()}function l(){return Boolean(n)}function p(){n||(n=i?i.addNestedSub(t):s.subscribe(t),o=W())}function b(){n&&(n(),n=void 0,o.clear(),o=L)}var f={addNestedSub:r,notifyNestedSubs:a,handleChangeWrapper:t,isSubscribed:l,trySubscribe:p,tryUnsubscribe:b,getListeners:function(){return o}};return f}var D=typeof window!="undefined"&&typeof window.document!="undefined"&&typeof window.document.createElement!="undefined"?c.exports.useLayoutEffect:c.exports.useEffect,H=function(i,n){return i===n};function K(s,i,n,o){var r=c.exports.useReducer(function(h){return h+1},0),a=r[1],t=c.exports.useMemo(function(){return Y(n,o)},[n,o]),l=c.exports.useRef(),p=c.exports.useRef(),b=c.exports.useRef(),f=c.exports.useRef(),m=n.getState(),g;try{if(s!==p.current||m!==b.current||l.current){var S=s(m);f.current===void 0||!i(S,f.current)?g=S:g=f.current}else g=f.current}catch(h){throw l.current&&(h.message+=`
The error may be correlated with this previous error:
`+l.current.stack+`

`),h}return D(function(){p.current=s,b.current=m,f.current=g,l.current=void 0}),D(function(){function h(){try{var y=n.getState();if(y===b.current)return;var C=p.current(y);if(i(C,f.current))return;f.current=C,b.current=y}catch(w){l.current=w}a()}return t.onStateChange=h,t.trySubscribe(),h(),function(){return t.tryUnsubscribe()}},[n,t]),g}function $(s){s===void 0&&(s=I);var i=s===I?V:function(){return c.exports.useContext(s)};return function(o,r){r===void 0&&(r=H);var a=i(),t=a.store,l=a.subscription,p=K(o,r,t,l);return c.exports.useDebugValue(p),p}}var G=$();const ze=()=>{const[s,i]=c.exports.useState([]),[n,o]=c.exports.useState(0),[r,a]=c.exports.useState({page:1,page_size:10}),[t,l]=c.exports.useState(!1),[p,b]=c.exports.useState(null),{userid:f}=G(e=>e.user),[m]=k.useForm();c.exports.useEffect(()=>{(async()=>{const{status:d,result:v}=await R(r);d&&(i(v.items),o(v.total))})()},[r]);const g=e=>{b(e),m.setFieldsValue({is_active:e.is_active,is_verified:e.is_verified}),l(!0)},S=e=>{_.confirm({title:"Are you sure delete this user?",content:"This action cannot be undone",async onOk(){await C(e)},onCancel(){console.log("Cancel")}})},h=e=>{_.confirm({title:"Confirm Edit",content:"Are you sure you want to save these changes?",onOk:async()=>{if(p){e.id=p.id,console.log(e),await P(e),l(!1),b(null);const{status:d,result:v}=await R(r);d&&i(v.items)}},onCancel(){console.log("Edit cancelled")}})},y=async e=>{_.confirm({title:"Confirm Password Reset",content:`Are you sure you want to reset this user's password to "12345678"?`,async onOk(){const{status:d}=await P({id:e,password:"12345678"});d&&z.success("Password reset successfully")}})},C=async e=>{await B(e);const{status:d,result:v}=await R(r);d&&i(v.items)},w=()=>{l(!1),b(null),m.resetFields()},T=[{title:"Email",dataIndex:"email",key:"email"},{title:"Superuser",dataIndex:"is_superuser",key:"is_superuser",render:e=>u(U,{color:e?"green":"volcano",children:e?"Yes":"No"})},{title:"Active",dataIndex:"is_active",key:"is_active",render:e=>u(U,{color:e?"green":"volcano",children:e?"Yes":"No"})},{title:"Verified",dataIndex:"is_verified",key:"is_verified",render:e=>u(U,{color:e?"green":"volcano",children:e?"Yes":"No"})},{title:"Action",key:"action",render:(e,d)=>{const v=d.id===f;return E(O,{children:[u(x,{onClick:()=>g(d),disabled:v,children:"Edit"}),u(x,{danger:!0,onClick:()=>S(d.id),disabled:v,children:"Delete"}),u(x,{onClick:()=>y(d.id),disabled:v,children:"Reset Password"})]})}}],M=(e,d)=>{a({page:e,page_size:d||10})};return E("div",{children:[u(j,{dataSource:s,columns:T,rowKey:"id",pagination:!1}),u(F,{total:n,current:r.page,pageSize:r.page_size,onChange:M}),u(_,{title:"Edit User",open:t,onCancel:w,footer:[u(x,{onClick:w,children:"Cancel"},"back"),u(x,{type:"primary",onClick:()=>m.submit(),children:"Save"},"submit")],children:E(k,{form:m,onFinish:h,children:[u(k.Item,{name:"is_active",label:"Active",valuePropName:"checked",children:u(N,{})}),u(k.Item,{name:"is_verified",label:"Verified",valuePropName:"checked",children:u(N,{})})]})})]})};export{ze as default};
