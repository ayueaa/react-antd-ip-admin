import{r as n,l as N,F as c,b as h,j as s,P as T,B as o,M as l,n as m,p as v,q as f,S as z,s as A,v as j}from"./index.cca6eaae.js";import{S as w}from"./index.36db9d26.js";import{T as O}from"./Table.6765d112.js";import"./styleChecker.779b73b6.js";import"./index.eef432e6.js";import"./index.bac779dc.js";const K=()=>{const[C,d]=n.exports.useState([]),[k,_]=n.exports.useState(0),[i,S]=n.exports.useState({page:1,page_size:10}),[b,u]=n.exports.useState(!1),[g,p]=n.exports.useState(null),{userid:x}=N(e=>e.user),[r]=c.useForm();n.exports.useEffect(()=>{(async()=>{const{status:t,result:a}=await m(i);t&&(d(a.items),_(a.total))})()},[i]);const P=e=>{p(e),r.setFieldsValue({is_active:e.is_active,is_verified:e.is_verified}),u(!0)},E=e=>{l.confirm({title:"Are you sure delete this user?",content:"This action cannot be undone",async onOk(){await D(e)},onCancel(){console.log("Cancel")}})},U=e=>{l.confirm({title:"Confirm Edit",content:"Are you sure you want to save these changes?",onOk:async()=>{if(g){e.id=g.id,console.log(e),await v(e),u(!1),p(null);const{status:t,result:a}=await m(i);t&&d(a.items)}},onCancel(){console.log("Edit cancelled")}})},I=async e=>{l.confirm({title:"Confirm Password Reset",content:`Are you sure you want to reset this user's password to "12345678"?`,async onOk(){const{status:t}=await v({id:e,password:"12345678"});t&&A.success("Password reset successfully")}})},D=async e=>{await j(e);const{status:t,result:a}=await m(i);t&&d(a.items)},y=()=>{u(!1),p(null),r.resetFields()},F=[{title:"Email",dataIndex:"email",key:"email"},{title:"Superuser",dataIndex:"is_superuser",key:"is_superuser",render:e=>s(f,{color:e?"green":"volcano",children:e?"Yes":"No"})},{title:"Active",dataIndex:"is_active",key:"is_active",render:e=>s(f,{color:e?"green":"volcano",children:e?"Yes":"No"})},{title:"Verified",dataIndex:"is_verified",key:"is_verified",render:e=>s(f,{color:e?"green":"volcano",children:e?"Yes":"No"})},{title:"Action",key:"action",render:(e,t)=>{const a=t.id===x;return h(z,{children:[s(o,{onClick:()=>P(t),disabled:a,children:"Edit"}),s(o,{danger:!0,onClick:()=>E(t.id),disabled:a,children:"Delete"}),s(o,{onClick:()=>I(t.id),disabled:a,children:"Reset Password"})]})}}],M=(e,t)=>{S({page:e,page_size:t||10})};return h("div",{children:[s(O,{dataSource:C,columns:F,rowKey:"id",pagination:!1}),s(T,{total:k,current:i.page,pageSize:i.page_size,onChange:M}),s(l,{title:"Edit User",open:b,onCancel:y,footer:[s(o,{onClick:y,children:"Cancel"},"back"),s(o,{type:"primary",onClick:()=>r.submit(),children:"Save"},"submit")],children:h(c,{form:r,onFinish:U,children:[s(c.Item,{name:"is_active",label:"Active",valuePropName:"checked",children:s(w,{})}),s(c.Item,{name:"is_verified",label:"Verified",valuePropName:"checked",children:s(w,{})})]})})]})};export{K as default};
